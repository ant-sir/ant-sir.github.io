<!DOCTYPE html>
<html lang="zh-cn">
<head prefix="og: https://ogp.me/ns#"><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  <title>Git学习笔记 | Ant-Home</title>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Canonical links -->
  <link rel="canonical" href="https://ant-sir.xyz/2013/05/05/learn-git/index.html">
  
  <!-- Alternative links -->
  
  <!-- Icon -->
  <link rel="apple-touch-icon" sizes="57x57" href="/icon/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/icon/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/icon/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/icon/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/icon/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/icon/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/icon/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/icon/apple-touch-icon-152x152.png">
  <link rel="icon" type="image/png" href="/icon/favicon-196x196.png" sizes="196x196">
  <link rel="icon" type="image/png" href="/icon/favicon-160x160.png" sizes="160x160">
  <link rel="icon" type="image/png" href="/icon/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="/icon/favicon-16x16.png" sizes="16x16">
  <link rel="icon" type="image/png" href="/icon/favicon-32x32.png" sizes="32x32">
  <meta name="msapplication-TileColor" content="#2f83cd">
  <meta name="msapplication-TileImage" content="/icon/mstile-144x144.png">
  <!-- CSS -->
  <!-- build:css build/css/navy.css -->
  <link rel="stylesheet" href="/css/navy.css">
  <!-- endbuild -->
  <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css">
  <!-- Google Analytics -->
  
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-61377615-1', 'auto');
  ga('send', 'pageview');
</script>

  <!-- Baidu auto push -->
  <script>
  (function(){
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();
  </script>
</head>

<body>
  <div id="container">
    <header id="header" class="wrapper">
  <div id="header-inner" class="inner">
    <h1 id="logo-wrap">
      <a href="/" id="logo">Hexo</a>
    </h1>
    <nav id="main-nav">
      <a href="/" class="main-nav-link">主页</a><a href="/categories/" class="main-nav-link">分类</a><a href="/archives/" class="main-nav-link">归档</a><a href="/about/" class="main-nav-link">关于</a>
      <a href="https://github.com/ant-sir/site" class="main-nav-link"><i class="fa fa-github-alt"></i></a>
      <div id="search-input-wrap">
        <div id="search-input-icon">
          <i class="fa fa-search"></i>
        </div>
        <input type="search" id="search-input" placeholder="Search...">
      </div>
    </nav>
    <div id="lang-select-wrap">
      <label id="lang-select-label"><i class="fa fa-globe"></i><span>简体中文</span></label>
      <select id="lang-select" data-canonical="">
        
          <option value="zh-cn" selected>简体中文</option>
        
      </select>
    </div>
    <a id="mobile-nav-toggle">
      <span class="mobile-nav-toggle-bar"></span>
      <span class="mobile-nav-toggle-bar"></span>
      <span class="mobile-nav-toggle-bar"></span>
    </a>
  </div>
</header>

    <div id="content-wrap">
  <div id="content" class="wrapper">
    <div id="content-inner">
      <article class="article-container" itemscope itemtype="https://schema.org/Article">
        <div class="article-inner">
          <div class="article">
            <div class="inner">
              <header class="article-header">
                <h1 class="article-title" itemprop="name">Git学习笔记</h1>
                <a href="https://github.com/ant-sir/site/edit/master/source/_posts/2013-05-05-learn-git.md" class="article-edit-link" title="改进本文"><i class="fa fa-pencil"></i></a>
              </header>
              <div class="article-content" itemprop="articleBody">
                <p>Git是开源社区送给每一个人的宝贝。使用Git多年了，但每次翻看Git相关的书籍（主要是蒋鑫老师的《GotGit权威指南》，感谢蒋鑫老师写出这么好的作品）都有新的收获，这里主要记录一些读书笔记，还有自己对Git的一些理解。<br><a id="more"></a></p>
<h2 id="基础操作" class="article-heading"><a href="#基础操作" class="headerlink" title="基础操作"></a>基础操作<a class="article-anchor" href="#基础操作" aria-hidden="true"></a></h2><p>Git的学习曲线可能比较陡峭，特别是有些命令变化多端，很容易让初学者混乱。但是一但了解了它的内部原理操作起来就如鱼得水了。</p>
<h3 id="几个常用的简单命令" class="article-heading"><a href="#几个常用的简单命令" class="headerlink" title="几个常用的简单命令"></a>几个常用的简单命令<a class="article-anchor" href="#几个常用的简单命令" aria-hidden="true"></a></h3><p>执行<code>git add -u</code>命令可以将所有已跟踪的修改过的文件加入暂存区。</p>
<p>执行<code>git add -A</code>命令可以将本地删除文件和新增文件都登记到提交暂存区。</p>
<p>执行<code>git add -p</code>命令可以对一个文件内的修改进行有选择性的添加。</p>
<p>执行<code>git commit [--] [&lt;file&gt;…​]</code>命令可以直接将未添加到暂存区的修改直接提交，类似svn的commit命令。</p>
<p>执行<code>git commit -p</code>命令可以交互式的选择所需要提交的内容。</p>
<p>执行<code>git log --oneline</code>命令可以以单行形式查看log。</p>
<p>执行<code>git log --stat</code>命令可以在查看log的同时看到文件变更。</p>
<p>执行<code>git log -p</code>命令可以在查看log的同时看到具体的修改内容。</p>
<h3 id="将从v1开始的历次提交逐一导出为补丁文件" class="article-heading"><a href="#将从v1开始的历次提交逐一导出为补丁文件" class="headerlink" title="将从v1开始的历次提交逐一导出为补丁文件"></a>将从v1开始的历次提交逐一导出为补丁文件<a class="article-anchor" href="#将从v1开始的历次提交逐一导出为补丁文件" aria-hidden="true"></a></h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git format-patch v1..HEAD</span><br><span class="line">0001-Fix-typo-help-to-help.patch</span><br><span class="line">0002-Add-I18N-support.patch</span><br><span class="line">0003-Translate-for-Chinese.patch</span><br></pre></td></tr></table></figure>
<p>显示版本库.git目录所在的位置<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git rev-parse --git-dir</span><br></pre></td></tr></table></figure></p>
<p>显示工作区根目录<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git rev-parse --show-toplevel</span><br></pre></td></tr></table></figure></p>
<p>相对于工作区根目录的相对目录<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git rev-parse --show-prefix</span><br></pre></td></tr></table></figure></p>
<p>从当前目录（cd）后退（up）到工作区的根的深度<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git rev-parse --show-cdup</span><br></pre></td></tr></table></figure></p>
<p><code>git config</code>命令操作任何其他的INI文件<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">GIT_CONFIG=test.ini git config a.b.c.d <span class="string">"hello, world"</span></span><br></pre></td></tr></table></figure></p>
<p>命令查看存储库对象的内容或类型和大小信息:</p>
<ul>
<li><code>git cat-file -t</code> 显示由<code>&lt;object&gt;</code>标识的对象类型</li>
<li><code>git cat-file -s</code> 显示由<code>&lt;object&gt;</code>标识的对象大小</li>
<li><code>git cat-file -p</code> 基于其类型，打印<code>&lt;object&gt;</code>的内容</li>
</ul>
<p><code>git ls-tree</code> 查看树对象的内容</p>
<h3 id="头指针HEAD和分支master的本质" class="article-heading"><a href="#头指针HEAD和分支master的本质" class="headerlink" title="头指针HEAD和分支master的本质"></a>头指针HEAD和分支master的本质<a class="article-anchor" href="#头指针HEAD和分支master的本质" aria-hidden="true"></a></h3><p>头指针使用<code>.git/HEAD</code>保存，头指针文件内部只保存一个分支的引用（如，master分支的引用<code>ref: refs/heads/master</code>），如果头指针内部保存的是提交ID，则处理分离头指针模式。<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ cat .git/HEAD</span><br><span class="line">ref: refs/heads/master</span><br></pre></td></tr></table></figure></p>
<p>分支引用内部存储的即为该分支的最新提交。<code>master</code>分支使用<code>.git/refs/heads</code>下对应的分支名master的文件来保存。<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ cat .git/refs/heads/master</span><br><span class="line">6fa67542c5fc78c89f896edce01cc76428d57e81</span><br></pre></td></tr></table></figure></p>
<p>远程分支目录<code>.git/refs</code>是保存引用的命名空间，其中<code>.git/refs/heads</code>目录下的引用又称为分支。对于分支既可以使用正规的长格式的表示法，如<code>refs/heads/master</code>，也可以去掉前面的两级目录用<code>master</code>来表示。Git 有一个底层命令<code>git rev-parse</code>可以用于显示引用对应的提交ID。</p>
<h3 id="对象的访问" class="article-heading"><a href="#对象的访问" class="headerlink" title="对象的访问"></a>对象的访问<a class="article-anchor" href="#对象的访问" aria-hidden="true"></a></h3><ol>
<li>符号<code>^</code>可以用于指代父提交。</li>
</ol>
<ul>
<li><code>HEAD^</code>代表版本库中上一次提交，即最近一次提交的父提交。</li>
<li><code>HEAD^^</code>则代表<code>HEAD^</code>的父提交。</li>
</ul>
<ol start="2">
<li>对于一个提交有多个父提交，可以在符号<code>^</code>后面用数字表示是第几个父提交。</li>
</ol>
<ul>
<li><code>a573106^2</code>含义是提交a573106的多个父提交中的第二个父提交。</li>
<li><code>HEAD^1</code>相当于<code>HEAD^</code>含义是HEAD多个父提交中的第一个。</li>
<li><code>HEAD^^2</code>含义是<code>HEAD^</code>（HEAD父提交）的多个父提交中的第二个。</li>
</ul>
<ol start="3">
<li><p>符号<code>~&lt;n&gt;</code>也可以用于指代祖先提交。<br>下面两个表达式效果等同：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">a573106~5</span><br><span class="line">a573106^^^^^</span><br></pre></td></tr></table></figure>
</li>
<li><p>提交所对应的树对象，可以用类似如下的语法访问。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">a573106^&#123;tree&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>某一此提交对应的文件对象，可以用如下的语法访问。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">a573106:path/to/file</span><br></pre></td></tr></table></figure>
</li>
<li><p>暂存区中的文件对象，可以用如下的语法访问。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">:path/to/file</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="git-reset的使用" class="article-heading"><a href="#git-reset的使用" class="headerlink" title="git reset的使用"></a>git reset的使用<a class="article-anchor" href="#git-reset的使用" aria-hidden="true"></a></h3><p>重置命令的一个用途就是修改引用（如master）的游标。体现为分支“游标”的变更。通过移动这个来实现分支的前进和后退。</p>
<p><code>git reset</code>命令有两种用法：<br>用法一：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git reset [-q] [&lt;commit&gt;] [--] &lt;paths&gt;...</span><br></pre></td></tr></table></figure></p>
<p>用法二：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git reset [--soft | --mixed | --hard | --merge | --keep] [-q] [&lt;commit&gt;]</span><br></pre></td></tr></table></figure></p>
<ul>
<li><p>上面列出了两个用法，其中 <code>&lt;commit&gt;</code> 都是可选项，可以使用引用或者提交ID，如果省略 <code>&lt;commit&gt;</code> 则相当于使用了HEAD的指向作为提交ID。</p>
</li>
<li><p>上面列出的两种用法的区别在于，第一种用法在命令中包含路径<code>&lt;paths&gt;</code>。为了避免路径和引用（或者提交ID）同名而冲突，可以在<code>&lt;paths&gt;</code>前用两个连续的短线（减号）作为分隔。</p>
</li>
<li><p>第一种用法（包含了路径<code>&lt;paths&gt;</code>的用法）不会重置引用，更不会改变工作区，而是用指定提交状态（<code>&lt;commit&gt;</code>）下的文件（<code>&lt;paths&gt;</code>）替换掉暂存区中的文件。</p>
</li>
<li><p>第二种用法（不使用路径<code>&lt;paths&gt;</code>的用法）则会重置引用。根据不同的选项，可以对暂存区或者工作区进行重置。</p>
</li>
<li><p>两种用法的参数不能混合使用，即带路径参数<code>--</code>或<code>&lt;paths&gt;</code>时不能再跟<code>soft/mixed/hard/merge/keep</code>任意一种。</p>
</li>
<li><p><code>git reset</code>什么都不加时，仅用HEAD指向的目录树重置暂存区，工作区不会受到影响，相当于将之前用git add命令更新到暂存区的内容撤出暂存区。引用也未改变，因为引用重置到HEAD相当于没有重置。</p>
</li>
</ul>
<h3 id="修补提交" class="article-heading"><a href="#修补提交" class="headerlink" title="修补提交"></a>修补提交<a class="article-anchor" href="#修补提交" aria-hidden="true"></a></h3><p>修补提交<code>git commit –amend</code>相当于下面两条命令：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git reset --soft HEAD^</span><br><span class="line">$ git commit -e -F .git/COMMIT_EDITMSG</span><br></pre></td></tr></table></figure></p>
<p>文件<code>.git/COMMIT_EDITMSG</code>保存了上次的提交日志。</p>
<h3 id="git-checkout检出" class="article-heading"><a href="#git-checkout检出" class="headerlink" title="git checkout检出"></a>git checkout检出<a class="article-anchor" href="#git-checkout检出" aria-hidden="true"></a></h3><p>如果HEAD的内容不能改变而一直都指向master分支，那么Git如此精妙的分支设计岂不浪费？如果HEAD要改变该如何改变呢？本章将学习检出命令（git checkout），该命令的实质就是修改HEAD本身的指向，该命令不会影响分支“游标”（如master）。</p>
<p>HEAD可以理解为“头指针”，是当前工作区的“基础版本”，当执行提交时，HEAD指向的提交将作为新提交的父提交。HEAD应该指向一个分支的引用。如果HEAD头指针指向了一个具体的提交ID，而不是一个引用（分支），就是处于“分离头指针”状态。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">用法一： git checkout [-q] [&lt;commit&gt;] [--] &lt;paths&gt;...</span><br><span class="line">用法二： git checkout [&lt;branch&gt;]</span><br><span class="line">用法三： git checkout [-m] [[-b|--orphan] &lt;new_branch&gt;] [&lt;start_point&gt;]</span><br></pre></td></tr></table></figure>
<ul>
<li>上面列出的第一种用法和第二种用法的区别在于，第一种用法在命令中包含路径<paths>。为了避免路径和引用（或者提交ID）同名而冲突，可以在<paths>前用两个连续的短线（减号）作为分隔。</paths></paths></li>
<li>第一种用法的<commit>是可选项，如果省略则相当于从暂存区（index）进行检出。这和上一章的重置命令大不相同：重置的默认值是 HEAD，而检出的默认值是暂存区。因此重置一般用于重置暂存区（除非使用–hard参数，否则不重置工作区），而检出命令主要是覆盖工作区（如果<commit>不省略，也会替换暂存区中相应的文件）。</commit></commit></li>
<li>第一种用法（包含了路径<paths>的用法）不会改变HEAD头指针，主要是用于指定版本的文件覆盖工作区中对应的文件。如果省略<commit>，会拿暂存区的文件覆盖工作区的文件，否则用指定提交中的文件覆盖暂存区和工作区中对应的文件。</commit></paths></li>
<li>第二种用法（不使用路径<paths>的用法）则会改变HEAD头指针。之所以后面的参数写作<branch>，是因为只有HEAD切换到一个分支才可以对提交进行跟踪，否则仍然会进入“分离头指针”的状态。在“分离头指针”状态下的提交不能被引用关联到而可能会丢失。所以用法二最主要的作用就是切换到分支。如果省略<branch>则相当于对工作区进行状态检查（注意，第一种用法中的<paths>是不可省略的，省略时只可能是后两种用法）。</paths></branch></branch></paths></li>
<li>第三种用法主要是创建和切换到新的分支（&lt;new_branch&gt;），新的分支从&lt;start_point&gt;指定的提交开始创建。新分支和我们熟悉的master分支没有什么实质的不同，都是在refs/heads命名空间下的引用。关于分支和git checkout命令的这个用法会在后面的章节做具体的介绍。</li>
</ul>
<p>比较特殊的命令<code>git checkout</code>什么也不加时，汇总显示工作区、暂存区与HEAD的差异。</p>
<h3 id="恢复已提交删除的文件" class="article-heading"><a href="#恢复已提交删除的文件" class="headerlink" title="恢复已提交删除的文件"></a>恢复已提交删除的文件<a class="article-anchor" href="#恢复已提交删除的文件" aria-hidden="true"></a></h3><p>执行删除并提交了之后，只是在最新的提交中删除了文件，历史提交中文件仍然保留，可以从历史提交中提取文件。</p>
<p>执行下面的命令可以从历史（前一次提交）中恢复已删除的文件到工作区。<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git cat-file -p HEAD~1:welcome.txt &gt; welcome.txt</span><br></pre></td></tr></table></figure></p>
<p>使用<code>git checkout</code>命令可以从某个提交中检出已文件到暂存区和工作区：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git checkout HEAD~1 -- welcome.txt</span><br></pre></td></tr></table></figure></p>
<p>使用<code>git reset</code>命令可以从某个提交中重置文件到暂存区：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git reset HEAD~1 -- welcome.txt</span><br></pre></td></tr></table></figure></p>
<h3 id="版本表示法：git-rev-parse" class="article-heading"><a href="#版本表示法：git-rev-parse" class="headerlink" title="版本表示法：git rev-parse"></a>版本表示法：git rev-parse<a class="article-anchor" href="#版本表示法：git-rev-parse" aria-hidden="true"></a></h3><p>命令<code>git rev-parse</code>是Git的一个底层命令，其功能非常丰富（或者说杂乱），很多Git脚本或工具都会用到这条命令。</p>
<ol>
<li><p>可以显示Git版本库的位置（<code>--git-dir</code>），当前工作区目录的深度（<code>--show-cdup</code>），甚至可以用于被Git无关应用用于解析命令行参数（<code>--parseopt</code>）。</p>
</li>
<li><p>此命令可以显示当前版本库中的引用:</p>
<ul>
<li><p>显示分支</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git rev-parse --symbolic --branches</span><br></pre></td></tr></table></figure>
</li>
<li><p>显示里程碑</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git rev-parse --symbolic --tags</span><br><span class="line">A</span><br><span class="line">B</span><br><span class="line">C</span><br><span class="line">D</span><br><span class="line">E</span><br><span class="line">F</span><br><span class="line">G</span><br><span class="line">H</span><br><span class="line">I</span><br><span class="line">J</span><br></pre></td></tr></table></figure>
</li>
<li><p>显示定义的所有引用</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git rev-parse --symbolic --glob=refs/*</span><br><span class="line">refs/heads/master</span><br><span class="line">refs/remotes/origin/HEAD</span><br><span class="line">refs/remotes/origin/master</span><br><span class="line">refs/tags/A</span><br><span class="line">refs/tags/B</span><br><span class="line">refs/tags/C</span><br><span class="line">refs/tags/D</span><br><span class="line">refs/tags/E</span><br><span class="line">refs/tags/F</span><br><span class="line">refs/tags/G</span><br><span class="line">refs/tags/H</span><br><span class="line">refs/tags/I</span><br><span class="line">refs/tags/J</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>命令<code>git rev-parse</code>另外一个重要的功能就是将一个Git对象表达式表示为对应的SHA1哈希值。</p>
<ul>
<li><p>显示HEAD对应的SHA1哈希值</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git rev-parse  HEAD</span><br><span class="line">6652a0dce6a5067732c00ef0a220810a7230655e</span><br></pre></td></tr></table></figure>
</li>
<li><p>命令<code>git describe</code>的输出也可以显示为SHA1哈希值</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git describe</span><br><span class="line">A-1-g6652a0d</span><br><span class="line">$ git rev-parse A-1-g6652a0d</span><br><span class="line">6652a0dce6a5067732c00ef0a220810a7230655e</span><br></pre></td></tr></table></figure>
</li>
<li><p>可以同时显示多个表达式的SHA1哈希值<br>下面的操作可以看出<code>master</code>和<code>refs/heads/master</code>都可以用于指代master分支。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git rev-parse  master  refs/heads/master</span><br><span class="line">6652a0dce6a5067732c00ef0a220810a7230655e</span><br><span class="line">6652a0dce6a5067732c00ef0a220810a7230655e</span><br></pre></td></tr></table></figure>
</li>
<li><p>可以用哈希值的前几位指代整个哈希值</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git rev-parse  6652  6652a0d</span><br><span class="line">6652a0dce6a5067732c00ef0a220810a7230655e</span><br><span class="line">6652a0dce6a5067732c00ef0a220810a7230655e</span><br></pre></td></tr></table></figure>
</li>
<li><p>里程碑的两种表示法均指向相同的对象<br>里程碑对象不一定是提交，有可能是一个Tag对象。Tag对象包含说明或者签名，还包括到对应提交的指向。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git rev-parse  A  refs/tags/A</span><br><span class="line">c9b03a208288aebdbfe8d84aeb984952a16da3f2</span><br><span class="line">c9b03a208288aebdbfe8d84aeb984952a16da3f2</span><br></pre></td></tr></table></figure>
</li>
<li><p>里程碑A指向了一个Tag对象而非提交的时候，用下面的三个表示法都可以指向里程碑对应的提交<br>实际上下面的语法也可以直接作用于轻量级里程碑（直接指向提交的里程碑）或者作用于提交本身。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git rev-parse  A^&#123;&#125;  A^0  A^&#123;commit&#125;</span><br><span class="line">81993234fc12a325d303eccea20f6fd629412712</span><br><span class="line">81993234fc12a325d303eccea20f6fd629412712</span><br><span class="line">81993234fc12a325d303eccea20f6fd629412712</span><br></pre></td></tr></table></figure>
</li>
<li><p>A的第一个父提交就是B所指向的提交<br>回忆之前的介绍，<code>^</code>操作符代表着父提交。当一个提交有多个父提交时，可以通过在符号<code>^</code>后面跟上一个数字表示第几个父提交。<code>A^</code> 就相当于 <code>A^1</code>。而<code>B^0</code>代表了B所指向的一个Commit对象（因为B是Tag对象）。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git rev-parse  A^  A^1  B^0</span><br><span class="line">776c5c9da9dcbb7e463c061d965ea47e73853b6e</span><br><span class="line">776c5c9da9dcbb7e463c061d965ea47e73853b6e</span><br><span class="line">776c5c9da9dcbb7e463c061d965ea47e73853b6e</span><br></pre></td></tr></table></figure>
</li>
<li><p>更为复杂的表示法<br>连续的<code>^</code>符号依次沿着父提交进行定位至某一祖先提交。<code>^</code>后面的数字代表该提交的第几个父提交。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git rev-parse  A^^3^2  F^2  J^&#123;&#125;</span><br><span class="line">3252fcce40949a4a622a1ac012cb120d6b340ac8</span><br><span class="line">3252fcce40949a4a622a1ac012cb120d6b340ac8</span><br><span class="line">3252fcce40949a4a622a1ac012cb120d6b340ac8</span><br></pre></td></tr></table></figure>
</li>
<li><p>记号<code>~&lt;n&gt;</code>就相当于连续<code>&lt;n&gt;</code>个符号<code>^</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git rev-parse  A~3  A^^^  G^0</span><br><span class="line">e80aa7481beda65ae00e35afc4bc4b171f9b0ebf</span><br><span class="line">e80aa7481beda65ae00e35afc4bc4b171f9b0ebf</span><br><span class="line">e80aa7481beda65ae00e35afc4bc4b171f9b0ebf</span><br></pre></td></tr></table></figure>
</li>
<li><p>显示里程碑A对应的目录树。下面两种写法都可以</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git rev-parse  A^&#123;tree&#125;  A:</span><br><span class="line">95ab9e7db14ca113d5548dc20a4872950e8e08c0</span><br><span class="line">95ab9e7db14ca113d5548dc20a4872950e8e08c0</span><br></pre></td></tr></table></figure>
</li>
<li><p>显示树里面的文件，下面两种表示法均可</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git rev-parse  A^&#123;tree&#125;:src/Makefile  A:src/Makefile</span><br><span class="line">96554c5d4590dbde28183e9a6a3199d526eeb925</span><br><span class="line">96554c5d4590dbde28183e9a6a3199d526eeb925</span><br></pre></td></tr></table></figure>
</li>
<li><p>暂存区里的文件和HEAD中的文件相同</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git rev-parse  :gitg.png  HEAD:gitg.png</span><br><span class="line">fc58966ccc1e5af24c2c9746196550241bc01c50</span><br><span class="line">fc58966ccc1e5af24c2c9746196550241bc01c50</span><br></pre></td></tr></table></figure>
</li>
<li><p>还可以通过在提交日志中查找字串的方式显示提交</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git rev-parse :/<span class="string">"Commit A"</span></span><br><span class="line">81993234fc12a325d303eccea20f6fd629412712</span><br></pre></td></tr></table></figure>
</li>
<li><p>reflog相关的语法</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git rev-parse HEAD@&#123;0&#125; master@&#123;0&#125;</span><br><span class="line">6652a0dce6a5067732c00ef0a220810a7230655e</span><br><span class="line">6652a0dce6a5067732c00ef0a220810a7230655e</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ol>
<h3 id="版本范围表示法：git-rev-list" class="article-heading"><a href="#版本范围表示法：git-rev-list" class="headerlink" title="版本范围表示法：git rev-list"></a>版本范围表示法：git rev-list<a class="article-anchor" href="#版本范围表示法：git-rev-list" aria-hidden="true"></a></h3><p>有的Git命令可以使用一个版本范围作为参数，命令<code>git rev-list</code>可以帮助研究Git的各种版本范围语法。<br><img src="/img/commit-tree-with-id.png" alt="commit-tree-with-id"></p>
<ul>
<li><p>一个提交ID实际上就可以代表一个版本列表。含义是：该版本开始的所有历史提交。</p>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git rev-list --oneline  A</span><br><span class="line">8199323 Commit A: merge B with C.</span><br><span class="line">0cd7f2e commit C.</span><br><span class="line">776c5c9 Commit B: merge D with E and F</span><br><span class="line">beb30ca Commit F: merge I with J</span><br><span class="line">212efce Commit D: merge G with H</span><br><span class="line">634836c commit I.</span><br><span class="line">3252fcc commit J.</span><br><span class="line">83be369 commit E.</span><br><span class="line">2ab52ad commit H.</span><br><span class="line">e80aa74 commit G.</span><br></pre></td></tr></table></figure>
</li>
<li><p>两个或多个版本，相当于每个版本单独使用时指代的列表的并集。</p>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git rev-list --oneline  D  F</span><br><span class="line">beb30ca Commit F: merge I with J</span><br><span class="line">212efce Commit D: merge G with H</span><br><span class="line">634836c commit I.</span><br><span class="line">3252fcc commit J.</span><br><span class="line">2ab52ad commit H.</span><br><span class="line">e80aa74 commit G.</span><br></pre></td></tr></table></figure>
</li>
<li><p>在一个版本前面加上符号（<code>^</code>）含义是取反，即排除这个版本及其历史版本。</p>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git rev-list --oneline  ^G D</span><br><span class="line">212efce Commit D: merge G with H</span><br><span class="line">2ab52ad commit H.</span><br></pre></td></tr></table></figure>
</li>
<li><p>和上面等价的“点点”表示法。使用两个点连接两个版本，如<code>G..D</code>，就相当于<code>^G D</code>。</p>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git rev-list --oneline  G..D</span><br><span class="line">212efce Commit D: merge G with H</span><br><span class="line">2ab52ad commit H.</span><br></pre></td></tr></table></figure>
</li>
<li><p>版本取反，参数的顺序不重要，但是“点点”表示法前后的版本顺序很重要。</p>
<ul>
<li><p>语法：<code>^B C</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git rev-list --oneline  ^B C</span><br><span class="line">0cd7f2e commit C.</span><br></pre></td></tr></table></figure>
</li>
<li><p>语法：<code>C ^B</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git rev-list --oneline  C ^B</span><br><span class="line">0cd7f2e commit C.</span><br></pre></td></tr></table></figure>
</li>
<li><p>语法：<code>B..C</code>相当于<code>^B C</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git rev-list --oneline  B..C</span><br><span class="line">0cd7f2e commit C.</span><br></pre></td></tr></table></figure>
</li>
<li><p>语法：<code>C..B</code>相当于<code>^C B</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git rev-list --oneline  C..B</span><br><span class="line">776c5c9 Commit B: merge D with E and F</span><br><span class="line">212efce Commit D: merge G with H</span><br><span class="line">83be369 commit E.</span><br><span class="line">2ab52ad commit H.</span><br><span class="line">e80aa74 commit G.</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>三点表示法的含义是两个版本共同能够访问到的除外。<br>  B和C共同能够访问到的F、I、J排除在外。</p>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git rev-list --oneline  B...C</span><br><span class="line">0cd7f2e commit C.</span><br><span class="line">776c5c9 Commit B: merge D with E and F</span><br><span class="line">212efce Commit D: merge G with H</span><br><span class="line">83be369 commit E.</span><br><span class="line">2ab52ad commit H.</span><br><span class="line">e80aa74 commit G.</span><br></pre></td></tr></table></figure>
</li>
<li><p>三点表示法，两个版本的前后顺序没有关系。<br>  实际上<code>r1...r2</code>相当于<code>r1 r2 --not $(git merge-base --all r1 r2)</code>，和顺序无关。</p>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git rev-list --oneline  C...B</span><br><span class="line">0cd7f2e commit C.</span><br><span class="line">776c5c9 Commit B: merge D with E and F</span><br><span class="line">212efce Commit D: merge G with H</span><br><span class="line">83be369 commit E.</span><br><span class="line">2ab52ad commit H.</span><br><span class="line">e80aa74 commit G.</span><br></pre></td></tr></table></figure>
</li>
<li><p>某提交的历史提交，自身除外，用语法<code>r1^@</code>表示。</p>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git rev-list --oneline  B^@</span><br><span class="line">beb30ca Commit F: merge I with J</span><br><span class="line">212efce Commit D: merge G with H</span><br><span class="line">634836c commit I.</span><br><span class="line">3252fcc commit J.</span><br><span class="line">83be369 commit E.</span><br><span class="line">2ab52ad commit H.</span><br><span class="line">e80aa74 commit G.</span><br></pre></td></tr></table></figure>
</li>
<li><p>提交本身不包括其历史提交，用语法<code>r1^!</code>表示。</p>
  <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ git rev-list --oneline  B^!</span><br><span class="line">776c5c9 Commit B: merge D with E and F</span><br><span class="line"></span><br><span class="line">$ git rev-list --oneline  F^! D</span><br><span class="line">beb30ca Commit F: merge I with J</span><br><span class="line">212efce Commit D: merge G with H</span><br><span class="line">2ab52ad commit H.</span><br></pre></td></tr></table></figure>
</li>
</ul>

              </div>
              <footer class="article-footer">
                <time class="article-footer-updated" datetime="2019-04-08T14:24:49.338Z" itemprop="dateModified">上次更新：2019-04-08</time>
                <a href="/2014/01/07/learn-python/" class="article-footer-prev" title="Python笔记"><i class="fa fa-chevron-left"></i><span>上一页</span></a><a href="/2013/08/07/cmake-usage/" class="article-footer-next" title="CMAKE使用"><span>下一页</span><i class="fa fa-chevron-right"></i></a>
              </footer>
              
<section id="comments">
  <div id="disqus_thread"></div>
</section>
<script>
  var disqus_shortname = 'antsir';
  var disqus_url = 'https://ant-sir.xyz/2013/05/05/learn-git/index.html';
  var disqus_title = "Git学习笔记";
  var disqus_config = function(){
    this.language = 'zh';
  };
  (function(){
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = 'https://go.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>

            </div>
          </div>
          <aside id="article-toc" role="navigation">
            <div id="article-toc-inner">
              <strong class="sidebar-title">目录</strong>
              <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#基础操作"><span class="toc-text">基础操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#几个常用的简单命令"><span class="toc-text">几个常用的简单命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#将从v1开始的历次提交逐一导出为补丁文件"><span class="toc-text">将从v1开始的历次提交逐一导出为补丁文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#头指针HEAD和分支master的本质"><span class="toc-text">头指针HEAD和分支master的本质</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#对象的访问"><span class="toc-text">对象的访问</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#git-reset的使用"><span class="toc-text">git reset的使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修补提交"><span class="toc-text">修补提交</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#git-checkout检出"><span class="toc-text">git checkout检出</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#恢复已提交删除的文件"><span class="toc-text">恢复已提交删除的文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#版本表示法：git-rev-parse"><span class="toc-text">版本表示法：git rev-parse</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#版本范围表示法：git-rev-list"><span class="toc-text">版本范围表示法：git rev-list</span></a></li></ol></li></ol>
              <a href="#" id="article-toc-top">回到顶部</a>
            </div>
          </aside>
        </div>
      </article>
      <aside id="sidebar" role="navigation">
  <div class="inner">
    <strong class="sidebar-title">欢迎</strong><a href="/categories" class="sidebar-link">欢迎</a><strong class="sidebar-title">学习笔记</strong><a href="/2014/01/07/learn-python/" class="sidebar-link">Python笔记</a><strong class="sidebar-title">工具使用</strong><a href="/2013/05/05/learn-git/" class="sidebar-link current">Git学习笔记</a><a href="/2013/08/07/cmake-usage/" class="sidebar-link">CMAKE使用</a><a href="/2013/07/03/google-repo/" class="sidebar-link">Google Repo</a>
    <strong class="sidebar-title">PYTHON</strong><a href="/2014/01/07/learn-python/" class="sidebar-link">Python笔记</a><strong class="sidebar-title">GIT</strong><a href="/2013/05/05/learn-git/" class="sidebar-link current">Git学习笔记</a><strong class="sidebar-title">CMAKE</strong><a href="/2013/08/07/cmake-usage/" class="sidebar-link">CMAKE使用</a><strong class="sidebar-title">REPO</strong><a href="/2013/07/03/google-repo/" class="sidebar-link">Google Repo</a>
 </div>
</aside>

    </div>
  </div>
</div>

    <footer id="footer" class="wrapper">
  <div class="inner">
    <div id="footer-copyright">
      &copy; 2019 <a href="https://ant-sir.xyz" target="_blank">Zhu Yanlei</a><br>
      Documentation licensed under <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank">CC BY 4.0</a>.
    </div>
    <div id="footer-links">
      <a href="https://weibo.com/5301170870" class="footer-link" target="_blank"><i class="fa fa-weibo"></i></a>
      <a href="https://github.com/ant-sir/site" class="footer-link" target="_blank"> <i class="fa fa-weixin" aria-hidden="true"></i></a>
      <a href="https://github.com/ant-sir/site" class="footer-link" target="_blank"> <i class="fa fa-qq" aria-hidden="true"></i></a>
      <a href="https://github.com/ant-sir/site" class="footer-link" target="_blank"><i class="fa fa-github-alt"></i></a>
    </div>
  </div>
</footer>

  </div>
  <div id="mobile-nav-dimmer"></div>
  <nav id="mobile-nav">
  <div id="mobile-nav-inner">
    <ul id="mobile-nav-list">
      <a href="/" class="mobile-nav-link">主页</a><a href="/categories/" class="mobile-nav-link">分类</a><a href="/archives/" class="mobile-nav-link">归档</a><a href="/about/" class="mobile-nav-link">关于</a>
      <li class="mobile-nav-item">
        <a href="https://github.com/ant-sir/site" class="mobile-nav-link" rel="external" target="_blank">GitHub</a>
      </li>
    </ul>
    
      <strong class="mobile-nav-title">欢迎</strong><a href="/categories" class="mobile-nav-link">欢迎</a><strong class="mobile-nav-title">学习笔记</strong><a href="/2014/01/07/learn-python/" class="mobile-nav-link">Python笔记</a><strong class="mobile-nav-title">工具使用</strong><a href="/2013/05/05/learn-git/" class="mobile-nav-link current">Git学习笔记</a><a href="/2013/08/07/cmake-usage/" class="mobile-nav-link">CMAKE使用</a><a href="/2013/07/03/google-repo/" class="mobile-nav-link">Google Repo</a>
      <strong class="mobile-nav-title">PYTHON</strong><a href="/2014/01/07/learn-python/" class="mobile-nav-link">Python笔记</a><strong class="mobile-nav-title">GIT</strong><a href="/2013/05/05/learn-git/" class="mobile-nav-link current">Git学习笔记</a><strong class="mobile-nav-title">CMAKE</strong><a href="/2013/08/07/cmake-usage/" class="mobile-nav-link">CMAKE使用</a><strong class="mobile-nav-title">REPO</strong><a href="/2013/07/03/google-repo/" class="mobile-nav-link">Google Repo</a>
    
  </div>
  <div id="mobile-lang-select-wrap">
    <span id="mobile-lang-select-label"><i class="fa fa-globe"></i><span>简体中文</span></span>
    <select id="mobile-lang-select" data-canonical="">
      
        <option value="zh-cn" selected>简体中文</option>
      
    </select>
  </div>
</nav>
  <!-- Scripts -->
<!-- Cookie -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/js-cookie/2.2.0/js.cookie.min.js"></script>
<!-- build:js build/js/main.js -->
<script src="/js/lang_select.js"></script>
<script src="/js/toc.js"></script>
<script src="/js/mobile_nav.js"></script>
<!-- endbuild -->
<!-- Algolia -->

<script>document.getElementById('search-input-wrap').classList.add('on');</script>
<script src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
<script>
  docsearch({
    // Your apiKey and indexName will be given to you once
    // we create your config
    apiKey: '36fb45dc14ef77aa8bdf5b2dbf75c87f',
    indexName: 'hexo-search',
    appId: 'IKDE0Z5WJI', // Should be only included if you are running DocSearch on your own.
    // Replace inputSelector with a CSS selector
    // matching your search input
    inputSelector: '#search-input',
    // Set debug to true if you want to inspect the dropdown
    debug: false,
  });
</script>


</body>
</html>
